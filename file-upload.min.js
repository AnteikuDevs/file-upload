"undefined"==typeof $&&alert("File Upload : Jquery is required!");let file_upload_acceptedFiles={mp3:{type:"audio",format:"audio/mpeg"},wav:{type:"audio",format:"audio/wav"},mp4:{type:"video",format:"video/mp4"},mkv:{type:"video",format:"video/mkv"},gif:{type:"image",format:"image/gif"},jpg:{type:"image",format:"image/jpeg"},jpeg:{type:"image",format:"image/jpeg"},png:{type:"image",format:"image/png"},webp:{type:"image",format:"image/webp"},svg:{type:"image",format:"image/svg+xml"},xlsx:{type:"file",format:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"},xls:{type:"file",format:"application/vnd.ms-excel"},csv:{type:"file",format:"text/csv"},pdf:{type:"file",format:"application/pdf"},docx:{type:"file",format:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"},doc:{type:"file",format:"application/msword"},ppt:{type:"file",format:"application/vnd.ms-powerpoint"},pptx:{type:"file",format:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}};function file_upload_GenerateRandId(e=10){for(var t="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=a.length,l=0;l<e;l++)t+=a.charAt(Math.floor(Math.random()*i));return t}function file_upload_createEvent(e,t,a){$(document).on(t,e,function(e){a(e,this)})}let modalId="__"+file_upload_GenerateRandId(17);$("body").append('<div class="file__upload_preview_backdrop"></div>').append(`<div class="file__upload_preview" ${modalId}><div class="file__upload_preview_dialog"><div class="file__upload_preview_content"><div class="file__upload_preview_header"><h4 class="file__upload_preview_title">Preview</h4><button class="file__upload_preview_btn_close" data-close="true"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M310.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L160 210.7 54.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L114.7 256 9.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 301.3 265.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L205.3 256 310.6 150.6z"/></svg></button></div><div class="file__upload_preview_body"></div><div class="file__upload_preview_footer"><button class="btn" data-close="true">Close</button></div></div></div></div>`),file_upload_createEvent("["+modalId+'] [data-close="true"]',"click",function(e){$("["+modalId+"]").addClass("hiding"),setTimeout(function(){$("body").removeClass("file__upload_show"),$("["+modalId+"] .file__upload_preview_body").html(""),$("["+modalId+"]").removeClass("show").removeClass("hiding")},230)}),file_upload_createEvent("["+modalId+"]","click",function(e,t){e.target==t&&($("["+modalId+"]").addClass("hiding"),setTimeout(function(){$("body").removeClass("file__upload_show"),$("["+modalId+"] .file__upload_preview_body").html(""),$("["+modalId+"]").removeClass("show").removeClass("hiding")},230))});class FileUpload{constructor(e,t={}){this.selector=e,this.config=t,this.accept=["*"],this.acceptInput=["*"],this.title=null,this.maxSize=null,this.maxFile=null,this.lang="en",this.customs=null,this.selectorId="",this.inputId="",this.contentId="",this.resultId="",this.browseId="",this.loadingId="",this.contentDragId="",this.data=[],this.deletedIds=[],this.validateConfig()}validateConfig(){let e=this.config,t=this;if(this.selector){if(0==$(this.selector).length)return!1;let a="__"+file_upload_GenerateRandId(9);$(this.selector).attr(a,""),this.selectorId="["+a+"]"}if(void 0!==e.title&&(this.title=e.title),void 0!==e.accept){if(!Array.isArray(e.accept))return console.log("Config {accept} is not array."),!1;let i=Array.isArray(e.accept)?e.accept:["*"],l=[];i.forEach(e=>{if("*"!=e){let t=null;if(!file_upload_acceptedFiles[e])return console.log("Accept (."+e+") format was not found."),!1;t=file_upload_acceptedFiles[e].format,l.push(t)}}),l.length&&(this.acceptInput=l),this.accept=i}if(void 0!==e.maxSize){if(isNaN(e.maxSize))return console.log("Config {maxSize} is not a number."),!1;this.maxSize=parseInt(e.maxSize)}if(void 0!==e.maxFile){if(isNaN(e.maxFile))return console.log("Config {maxFile} is not a number."),!1;this.maxFile=parseInt(e.maxFile)}if(void 0!==e.customs&&$.each(e.customs,function(e,a){$(t.selectorId).get(0).style.setProperty("--file-upload-"+e,a),$("["+modalId+"]").get(0).style.setProperty("--file-upload-"+e,a)}),void 0!==e.lang){if(!["id","en"].includes(e.lang))return console.log("Config {lang} only id and en"),!1;this.lang=e.lang}this.draw()}draw(){let e=this.drawContent();$(this.selectorId).addClass("file__upload"),$(this.selectorId).html(e)}drawContent_info_format(){let e=Array.isArray(this.accept)?this.accept:["*"],t=[];e.forEach(e=>{void 0!=file_upload_acceptedFiles[e]&&t.push("."+e)});let a=t.join(", "),i="All file formats";"id"==this.lang&&(i="Semua format file"),a&&(i="Format : <strong>"+a+"</strong>","id"==this.lang&&(i="Format : <strong>"+a+"</strong>"));let l=this.maxSize?parseInt(this.maxSize):null,d="";null!=l&&(d=`Max : <strong>${l}MB</strong>`,"id"==this.lang&&(d=`Maksimal : <strong>${l}MB</strong>`));let s=[i,d],o="";return $.each(s,function(e,t){o+=`<span class="file__upload_info_span">${t}</span>`}),o}drawContent_info(){let e=this.config,t=e.title?e.title:null,a="";return t&&(a=`<h4 class="file__upload_info_title">${t}</h4>`),`<div class="file__upload_info">${a}${this.drawContent_info_format()}</div>`}drawContent_action(){let e=this,t="__"+file_upload_GenerateRandId(7);this.inputId="["+t+"]";let a="__"+file_upload_GenerateRandId(8);this.browseId="["+a+"]";let i=$(document.createElement("div")).append($(document.createElement("input")).attr({type:"file",accept:this.acceptInput,hidden:!0,multiple:!0,[t]:""})),l="Browse";"id"==this.lang&&(l="Jelajahi"),$("body").append(i);let d=`<div class="file__upload_action"><button class="file__upload_action_browse" ${a}>${l}</button></div>`;return file_upload_createEvent("["+a+"]","click",function(e){$("["+t+"]").trigger("click")}),file_upload_createEvent("["+t+"]","change",function(t){t.target.files.length&&e.renderUpload(t.target.files)}),d}drawContent_loading(){let e="__"+file_upload_GenerateRandId(7);return this.loadingId="["+e+"]",`<div class="file__upload_loading" ${e}></div>`}drawContent_dragEvent(){let e="__"+file_upload_GenerateRandId(7);return this.contentDragId="["+e+"]",`<div class="file__upload_dragged" ${e}></div>`}loading(e="show"){"show"==e?($(this.loadingId).css("zIndex",1),$(this.loadingId).html('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; background: none; display: block; shape-rendering: auto;" width="200px" height="200px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid"><circle cx="50" cy="50" r="32" stroke-width="8" stroke="#2b3252" stroke-dasharray="50.26548245743669 50.26548245743669" fill="none" stroke-linecap="round"><animateTransform attributeName="transform" type="rotate" repeatCount="indefinite" dur="1s" keyTimes="0;1" values="0 50 50;360 50 50"></animateTransform></circle></svg>')):($(this.loadingId).css("zIndex","-1"),$(this.loadingId).html(""))}drawContent(){let e="";null!=this.maxFile&&(e=`<span class="file__upload_highlight">Max: ${this.maxFile} file</span>`);let t=`<div class="file__upload_icon"><div class="file__upload_icon_svg"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M152 120c-26.51 0-48 21.49-48 48s21.49 48 48 48s48-21.49 48-48S178.5 120 152 120zM447.1 32h-384C28.65 32-.0091 60.65-.0091 96v320c0 35.35 28.65 64 63.1 64h384c35.35 0 64-28.65 64-64V96C511.1 60.65 483.3 32 447.1 32zM463.1 409.3l-136.8-185.9C323.8 218.8 318.1 216 312 216c-6.113 0-11.82 2.768-15.21 7.379l-106.6 144.1l-37.09-46.1c-3.441-4.279-8.934-6.809-14.77-6.809c-5.842 0-11.33 2.529-14.78 6.809l-75.52 93.81c0-.0293 0 .0293 0 0L47.99 96c0-8.822 7.178-16 16-16h384c8.822 0 16 7.178 16 16V409.3z"/></svg></div>${e}</div>`,a="__"+file_upload_GenerateRandId(4)+"__";this.contentId="["+a+"]";let i=`<div class="file__upload_content" ${a}>${t}${this.drawContent_info()}${this.drawContent_action()}${this.drawContent_loading()}${this.drawContent_dragEvent()}</div>${this.drawError()}${this.drawResult()}`;return this.renderEventDragAndDrop(),i}drawError(){let e="__"+file_upload_GenerateRandId(11);return this.errorId="["+e+"]",`<div class="file__upload_error" ${e}></div>`}drawResult(){let e="__"+file_upload_GenerateRandId(11);return this.resultId="["+e+"]",`<div class="file__upload_result" ${e}></div>`}renderEventDragAndDrop(){let e=this;file_upload_createEvent(this.contentId,"dragover",function(t,a){t.preventDefault(),$(a).addClass("drag"),$(e.browseId).addClass("disabled")}),file_upload_createEvent(this.contentId,"dragleave",function(t,a){t.preventDefault(),$(a).removeClass("drag"),$(e.browseId).removeClass("disabled")}),file_upload_createEvent(this.contentId,"drop",function(t,a){t.preventDefault();var i=t.originalEvent.dataTransfer.files;$(a).addClass("drop"),e.renderUpload(i),$(e.browseId).removeClass("disabled")})}renderUpload(e){let t=this,a=t.lang,i=[],l=this.data.length;if(null!=this.maxFile&&l+e.length>this.maxFile&&("id"==a?i.push(`File yang diunggah melebihi ${this.maxFile}`):i.push(`Uploaded files exceed ${this.maxFile}`)),this.loading("show"),$.each(e,function(l,d){let s=d.type,o=d.size,n=d.name,r=n;if(r.length>25&&(r=r.substr(0,10)+"...."+r.substr(r.length-10,r.length)),"*"==t.accept[0]||t.acceptInput.includes(s)||("id"==a?i.push(`<strong class="file__upload_error_filename">"${r}"</strong> format tidak sesuai`):i.push(`The uploaded <strong class="file__upload_error_filename">"${r}"</strong> file format does not match`)),null!=t.maxSize&&o>1e6*t.maxSize&&("id"==a?i.push(`Ukuran maksimal file <strong class="file__upload_error_filename">"${r}"</strong> harus ${t.maxSize}MB`):i.push(`The maximum size of the <strong class="file__upload_error_filename">"${r}"</strong> file must be ${t.maxSize}MB`)),0==i.length){var p=new FileReader;p.addEventListener("load",function(e){let a=e.target.result,l={id:("__"+file_upload_GenerateRandId(13)).toString(),name:n,size:o/1e3,type:s,fileType:t.getAcceptFileType(s),data:a};0==i.length&&t.drawUploadFile(l)}),p.readAsDataURL(d)}e.length==l+1&&($(t.inputId).val(""),setTimeout(()=>{t.loading("hide")},300))}),$(this.errorId).html(""),i.length){let d="";$.each(i,function(e,t){let a="--"+file_upload_GenerateRandId(9);d+=`<span class="file__upload_error_item" ${a}>${t}</span>`,file_upload_createEvent("["+a+"]","click",function(e){e.preventDefault(),$(e.target).remove()})}),$(this.errorId).html(d)}setTimeout(function(){$(t.contentId).removeClass("drop drag")},300)}getAcceptFileType(e){let t="";return $.each(file_upload_acceptedFiles,function(a,i){i.format==e&&(t=i.type)}),t}drawUploadFile(e){let t=this,a="",i="__"+file_upload_GenerateRandId(16);"image"==this.getAcceptFileType(e.type)&&(a=`<div class="file__upload_result_image" ${i}><img src="${e.data}" alt="${e.name}"></div>`,file_upload_createEvent("["+i+"]","click",function(a){t.previewFile(e)})),("video"==this.getAcceptFileType(e.type)||"audio"==this.getAcceptFileType(e.type))&&(a=`<div class="file__upload_result_image" ${i}><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></div>`,file_upload_createEvent("["+i+"]","click",function(a){t.previewFile(e)}));let l="__"+file_upload_GenerateRandId(10);file_upload_GenerateRandId(12);let d=e.name;d.length>25&&(d=d.substr(0,10)+"...."+d.substr(d.length-10,d.length));let s=`<div class="file__upload_result_item" ${e.id}>${a}<div class="file__upload_result_info"><h4 class="file__upload_result_info_title">${d}</h4><span class="file_upload_result_info_span">${e.size} KB</span></div><div class="file__upload_result_action"><button class="file__upload_result_action_close" ${l}><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M310.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L160 210.7 54.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L114.7 256 9.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 301.3 265.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L205.3 256 310.6 150.6z"/></svg></button></div></div>`;file_upload_createEvent("["+l+"]","click",function(a){t.removeUploadedFile(e.id)}),this.data.push(e),null!=this.maxFile&&this.data.length==this.maxFile&&$(this.browseId).addClass("disabled"),$(this.resultId).append(s)}removeUploadedFile(e){let t=[];$.each(this.data,function(a,i){i.id!=e.toString()&&t.push({id:i.id,name:i.name,size:i.size,type:i.type,data:i.data})}),this.data=t,$("["+e+"]").fadeOut(200),setTimeout(()=>{$("["+e+"]").remove()},200),$(this.browseId).removeClass("disabled")}previewFile(e){let t=`<img src="${e.data}" alt="${e.name}">`;"video"==e.fileType&&(t=`<video autoplay controls style="width: 100%"><source type="${e.type}" src="${e.data}"></source></video>`),"audio"==e.fileType&&(t=`<audio autoplay controls style="width: 100%"><source type="${e.type}" src="${e.data}"></source></audio>`);let a="Previews",i="Close";"id"==this.lang&&(a="Pratinjau",i="Tutup"),$("["+modalId+"]").find(".file__upload_preview_title").html(a),$("["+modalId+"]").find(".file__upload_preview_body").html(t),$("["+modalId+"]").find(".file__upload_preview_footer .btn").text(i),$("["+modalId+"]").addClass("show"),$("body").addClass("file__upload_show")}getValue(e=!1){if(!1==e)return this.data;let t=[];return $.each(this.data,function(e,a){t.push(a.data)}),t}drawSetValue(e){let t=this,a="",i="__"+file_upload_GenerateRandId(16);"image"==this.getAcceptFileType(e.type)&&(a=`<div class="file__upload_result_image" ${i}><img src="${e.data}" alt="${e.name}"></div>`,file_upload_createEvent("["+i+"]","click",function(a){t.previewFile(e)})),"video"==this.getAcceptFileType(e.type)&&(a=`<div class="file__upload_result_image" ${i}><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512"><path d="M73 39c-14.8-9.1-33.4-9.4-48.5-.9S0 62.6 0 80V432c0 17.4 9.4 33.4 24.5 41.9s33.7 8.1 48.5-.9L361 297c14.3-8.7 23-24.2 23-41s-8.7-32.2-23-41L73 39z"/></svg></div>`,file_upload_createEvent("["+i+"]","click",function(a){t.previewFile(e)}));let l="__"+file_upload_GenerateRandId(10),d=(file_upload_GenerateRandId(12),"__"+file_upload_GenerateRandId(13)),s=`<div class="file__upload_result_item" ${d}>${a}<div class="file__upload_result_info"><h4 class="file__upload_result_info_title">${e.name}</h4></div><div class="file__upload_result_action"><button class="file__upload_result_action_close" ${l}><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path d="M310.6 150.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L160 210.7 54.6 105.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L114.7 256 9.4 361.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 301.3 265.4 406.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L205.3 256 310.6 150.6z"/></svg></button></div></div>`;file_upload_createEvent("["+l+"]","click",function(a){t.removeSetValue(d,e.id)}),null!=this.maxFile&&this.data.length==this.maxFile&&$(this.browseId).addClass("disabled"),$(this.resultId).append(s)}removeSetValue(e,t){this.deletedIds.push(t),$("["+e+"]").fadeOut(200),setTimeout(()=>{$("["+e+"]").remove()},200),$(this.browseId).removeClass("disabled")}setValue(e){let t=this;if(!Array.isArray(e))return alert("setData not in array!"),!1;let a=[];$.each(e,function(e,i){if(i.data){let l=i.data.split(".").pop(),d=i.name?i.name:i.data.split("/").pop(),s={id:i.id,name:d,type:file_upload_acceptedFiles[l].format,data:i.data};t.drawSetValue(s),a.push(s)}}),this.currentData=a}clearValue(){if(this.currentData.length){let e=[];$.each(this.currentData,function(t,a){e.push(a.id)}),this.deletedIds=e}this.data=[],$(this.contentId).html("")}}